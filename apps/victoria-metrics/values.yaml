## Overrides for victoria-metrics-k8s-stack Helm chart

# Shorten generated resource names to stay within 63-char K8s limit
fullnameOverride: vm-stack

# Required when deploying via ArgoCD: fixes VMServiceScrape label selectors
argocdReleaseOverride: victoria-metrics

# PRODUCTION: switch to vmcluster (vmselect/vminsert/vmstorage) for HA and horizontal scaling.
# VMSingle is fine here, single node, no replication needed for a demo.
vmsingle:
  spec:
    # PRODUCTION: potentially 14d+ retention, backed by persistent EBS/PD volumes with snapshots
    retentionPeriod: "1d"
    storage:
      resources:
        requests:
          # PRODUCTION: size based on ingestion rate Ã— retention
          storage: 2Gi
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

vmagent:
  spec:
    resources:
      requests:
        cpu: 50m
        memory: 128Mi
      limits:
        cpu: 200m
        memory: 256Mi

# PRODUCTION: enable both: VMAlert for recording/alerting rules, Alertmanager for routing
# to Slack/PagerDuty. Without these there's no on-call alerting.
vmalert:
  enabled: false

alertmanager:
  enabled: false

defaultDashboards:
  enabled: true

grafana:
  enabled: true
  # PRODUCTION: use External Secrets Operator to pull from Vault/AWS Secrets Manager/GC Secret Manager
  adminPassword: admin
  sidecar:
    dashboards:
      enabled: true
      label: grafana_dashboard
      labelValue: "1"
      searchNamespace: ALL
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

prometheus-node-exporter:
  resources:
    requests:
      cpu: 20m
      memory: 32Mi
    limits:
      cpu: 100m
      memory: 64Mi

kube-state-metrics:
  resources:
    requests:
      cpu: 20m
      memory: 32Mi
    limits:
      cpu: 100m
      memory: 64Mi

victoria-metrics-operator:
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi
